
\section{Elements of combinatorics calculus}

\subsection{Permutations $P_n$}

Given a vector $\left ( a_1, \ldots, a_n \right) $ the number of
permutations (or the possible ways to order the elements $a_i$) is
$n!$. A simple proof of that is as follow: for the position 1 are
available $n$ elements, for the second position (after fixing the
first) are available $n-1$ elements arriving to the position $n$ where
only one element is left, hence $n!$.

It is interesting to show how to add a new element $a_{n+1}$ to
existing permutations from the set $\left \lbrace a_1, \ldots,
  a_n\right\rbrace $, this is indeed another proof (by induction) to
the number $n!$ justified above. Having the permutations of length $n$
by hypothesis, we study how is it possible to add $a_{n+1}$ into a
given permutation $w = \left ( a_1, a_2, \ldots, a_n\right) $:
\begin{displaymath}
  \begin{split}
    &\left ( a_{n+1}, a_1, a_2, \ldots, a_n\right)\\
    &\left ( a_1, a_{n+1}, a_2, \ldots, a_n\right)\\
    &\ldots\\
    &\left ( a_1, a_2, \ldots, a_{n+1}, a_n\right)\\
    &\left ( a_1, a_2, \ldots, a_n, a_{n+1}\right)\\    
  \end{split}
\end{displaymath}
Those new vectors are $n+1$ because in the original permutation $w =
\left ( a_1, a_2, \ldots, a_n\right) $ there are $n-1$ ``internal
holes'' between the consecutive elements $a_i$ and $a_{i+1}$, plus the
left-most and right-most ``external holes'' $(\Box, a_1,...)$ and
$(..., a_n, \Box)$. So far we've considered only one permutation $w$
of $n$ elements, repeating the same reasoning for the others $w_i$
(which are $n!-1$), it must exists $n+1$ new vectors for each of
them. So the number of permutation of $n+1$ elements is $(n+1)n! =
(n+1)!$ (what we would have expected).

\subsection{Dispositions $D_{n,k}$}

A special case of permutations are dispositions, that is the number of
different ways in which $k$ elements can be chosen from a set of
length $n$, with $n \geq k$. We have $n$ elements available for the
first choice, $n-1$ for the second choice arriving to $n-k+1$ elements
for the $k$-th choice, hence $D_{n,k} = n(n-1)\cdots(n-k+1)$.  We can
write an example to show how to build dispositions. Let $\Omega =
\left \lbrace a,b,c, d\right\rbrace $ and we want to build $D_{4,2}$,
that is the set of ordered pairs, paying attention that $ \forall i:
(i,i)\not \in D_{n,2}$. The following pairs are the candidates (the
pairs of the form $(i,i)$ aren't listed because after we choose $i$
for the first position it isn't possible to choose it again for the
second):
\begin{displaymath}
  \begin{split}
    \left ( a, b \right)\quad
    \left ( a, c \right)\quad
    \left ( a, d \right)\\
    \left ( b, a \right)\quad
    \left ( b, c \right)\quad
    \left ( b, d \right)\\
    \left ( c, a \right)\quad
    \left ( c, b \right)\quad
    \left ( c, d \right)\\
    \left ( d, a \right)\quad
    \left ( d, b \right)\quad
    \left ( d, c \right)\\
  \end{split}
\end{displaymath}
We've build the previous matrix because we take care about
the order in which the pairs are built. In the next section we'll see
that there exists another set that doesn't take care of the order.

\subsection{Combinations $C_{n,k}$}

A special case of dispositions are combinations. With combinations,
notation $C_{n,k}$, we mean a set of sets $\left \lbrace \left \lbrace
    a_{i_1}, \ldots, a_{i_k} \right\rbrace \right\rbrace$ without
regard to the order in which $a_{i_1}, \ldots, a_{i_k}$ appear. We can
see combinations like dispositions modulo the symmetric relation:
$(j,i) \in C_{n,2} \rightarrow (i, j) \not \in C_{n,2}$ and $(i,i)\not
\in C_{n,2}, \forall i$). The following sub matrix is to combinations
as the previous one is to dispositions:
\begin{displaymath}
  \begin{split}
    \left ( a, b \right)\quad
    \left ( a, c \right)\quad
    \left ( a, d \right)\\
    \quad
    \left ( b, c \right)\quad
    \left ( b, d \right)\\
    \quad
    \quad
    \left ( c, d \right)\\
    \quad
    \quad
    \\
  \end{split}
\end{displaymath}
The combinations matrix is obtained by the disposition matrix, breaking
the symmetry, only half of them belongs to the dispositions
$C_{4,2}$. Hence $C_{n,k} = {{n}\choose{k}} = \frac{D_{n,k}}{k!} =
\frac{n(n-1)\cdots(n-k+1)}{k!} = \frac{n!}{k!(n-k)!)} $.

\subsection{Binomial coefficients}

In this section we study the binomial coefficients, and in the
particular the writing $(a + b)^n, n\in \mathbb{N}$. It is known that:
\begin{displaymath}
  (a+b)^n = \sum_{k=0}^{n}{{{n}\choose{k}}a^k b^{n-k} } 
\end{displaymath}
Now we study $(a + b)^r = \sum_{k=0}^{r}{{{r}\choose{k}}a^k b^{r-k} },
r\in \mathbb{R}$, in particular we have to pay attention to the
binomial coefficient when $r\in \mathbb{R}$:
\begin{displaymath}
  {{r}\choose{k}}  = \frac{r(r-1)\cdots(r-k+1)}{k!}
\end{displaymath}
The previous product make sense, instead we would have had problem
with $ \frac{r!}{k!(r-k)!} $. Now do simple manipulation:
\begin{displaymath}
  (a+b)^r = \left( a\left(1 +  \frac{b}{a}\right)\right)^r =
  a^r \left(1 +  \frac{b}{a}\right)^r
\end{displaymath}
In general we can call $z= \frac{b}{a} $ and reduce to study the
function $f(z)=(1+z)^r$, which can be expanded with Taylor:
\begin{displaymath}
  f(z) = \sum_{k \geq 0}{ \frac{f^{(k)}(0)}{k!} z^k } 
\end{displaymath}
Study the derivatives of $f(z)$:
\begin{displaymath}
  \begin{split}
    f^{(0)}(0) &= 1 \\
    f^{(1)}(z) &= r(1+z)^{r-1} \quad \rightarrow
    \quad f^{(1)}(0) =    r\\
    f^{(2)}(z) &= r(r-1)(1+z)^{r-2} \quad \rightarrow
    \quad f^{(2)}(0) = r(r-1)\\
    f^{(k)}(z) &= r(r-1)\cdots(r-k+1)(1+z)^{r-k}
    \quad \rightarrow \quad f^{(k)}(0) = r(r-1)\cdots(r-k+1)\\
  \end{split}
\end{displaymath}
Now we can substitute the previous into $f(z)$:
\begin{displaymath}
  f(z) = \sum_{k \geq 0}{ \frac{f^{(k)}(0)}{k!} z^k } =
  \sum_{k \geq 0}{ \frac{r(r-1)\cdots(r-k+1)}{k!} z^k } =
  \sum_{k \geq 0}{ {{r}\choose{k}} z^k }
\end{displaymath}

\begin{exercise}
  \label{exercise:first-on-comb-with-real}
  Compute ${{ \frac{1}{2} }\choose{3}} $.
\end{exercise}
\begin{proof}[Sol]
  It is sufficient to build a function $f(z) = (1+z)^r$ with the right
  value for $r$ and then expand $f(z)$ with Taylor, the coefficient of
  $z^3$ is the desired value ${{ r }\choose{3}} $.
  
  In this case $r= \frac{1}{2} $, so $f(z) = \sqrt{1+z} =
  {{\frac{1}{2}}\choose{0}}z^0 + {{\frac{1}{2}}\choose{1}}z^1 +
  {{\frac{1}{2}}\choose{2}}z^2 + {{\frac{1}{2}}\choose{3}}z^3 + \ldots$

  Using Maxima we expand with Taylor:
  \\\texttt{f(z):=sqrt(1+z);\\taylor(f(z), z, 0, 6),numer;}\\
  Getting:
  \begin{displaymath}
    f(z) = 1+z/2-z^2/8+z^3/16-(5*z^4)/128+(7*z^5)/256-(21*z^6)/1024+...
  \end{displaymath}
  Now we do a simple check:
  \\\texttt{mapBinomial(x):=binomial (1/2, x);\\
    map (mapBinomial, [0, 1, 2, 3, 4, 5, 6]);}\\
  Getting:
  \begin{displaymath}
    [1,1/2,-1/8,1/16,-5/128,7/256,-21/1024]
  \end{displaymath}
\end{proof}

Now suppose to have ${{-n}\choose{k}}, n\in \mathbb{N}  $:
\begin{displaymath}
  {{-n}\choose{k}} =  \frac{-n(-n-1)\cdots(-n-k+1)}{k!} 
\end{displaymath}
At the numerator there are $k$ terms, so factor -1:
\begin{displaymath}
  \begin{split}
    {{-n}\choose{k}} &= \frac{(-1)^k (n + k-1)\cdots(n+1)n}{k!} =
    \frac{(-1)^k (n + k-1)\cdots(n+1)n(n-1)!}{k!(n-1)!}\\
    &= \frac{(-1)^k (n + k-1)!}{k!(n-1)!} = (-1)^k {{n+k-1}\choose{k}}
  \end{split}
\end{displaymath}

\subsection{Central Binomial Coefficients and Catalan Numbers}

We introduce in the following paragraph a very important class of
numbers, the Catalan numbers. We proceed step by step, making an
observation on a rewriting for ${{n}\choose{k}}$ where $n,k\in
\mathbb{N} $.

Given a set of $n$ elements $a_1, \ldots,a_n$ it is possible to
generate the set $S$ of the combinations of length $k$. Now choose an
element, let say $a_j$, and partition $S$ in two set:
\begin{displaymath}
  \begin{split}
    S_{a_j}^+ &= \left \lbrace (a_{\pi(1)}, \ldots, a_{\pi(k)}) |
      \exists i: a_j = a_{\pi(i)} \right\rbrace \\
    S_{a_j}^- &= \left \lbrace (a_{\pi(1)}, \ldots, a_{\pi(k)}) |
      \forall i: a_j \not = a_{\pi(i)} \right\rbrace \\    
  \end{split}
\end{displaymath}
where $\pi: \left \lbrace 1, \ldots, k \right\rbrace \rightarrow \left
  \lbrace 1, \ldots, n \right\rbrace $ is one-to-one. The following
holds:
\begin{displaymath}
  {{n}\choose{k}} = \left| S_{a_j}^+ \right| + \left| S_{a_j}^-
  \right| = {{n-1}\choose{k-1}} +  {{n-1}\choose{k}}
\end{displaymath}
\begin{proof}
  We've chosen $a_j$ to partition $S$, hence
  \begin{itemize}
  \item $\left| S_{a_j}^+ \right| = {{n-1}\choose{k-1}}$ because
    $S_{a_j}^+$ contains sets which everyone contains $a_j$. But we
    can build $ S_{a_j}^+$ from scratch choosing $k-1$ elements ($a_j$
    is contained in every set of $S_{a_j}^+$, hence we have to build
    combinations of length $k-1$) from $\left \lbrace a_1, \ldots, a_n
    \right\rbrace \setminus \left \lbrace a_j \right\rbrace $ ($a_j$
    is an implicit choice)
  \item $\left| S_{a_j}^- \right| = {{n-1}\choose{k}}$ because $
    S_{a_j}^-$ contains sets which everyone doesn't contains
    $a_j$. But we can build $ S_{a_j}^- $ from scratch choosing $k$
    elements ($a_j$ isn't contained in any set of $S_{a_j}^-$, hence
    we have to build combinations of length $k$) from $\left \lbrace
      a_1, \ldots, a_n \right\rbrace \setminus \left \lbrace a_j
    \right\rbrace $ ($a_j$ is an impossible choice)
  \end{itemize}
\end{proof}

The recurrence $ {{n}\choose{k}} = {{n-1}\choose{k-1}} +
{{n-1}\choose{k}}$ allow us to build an infinite matrix reported in
\autoref{tab:central-binomial-coefficients} with interesting numbers
written inside a ticket as $\ticket{j}$.
\begin{table}[ht]
  \caption{Central Binomial Coefficients}
  \label{tab:central-binomial-coefficients}
  \begin{center}
    \begin{tabular}{c|ccccccccc}
      & 0 & 1 & 2 & 3 & 4 & 5 & 6 & \ldots & $k$ \\
      \hline
      0 & $\ticket{1}$ &  &  &  & & &  &  &\\
      1 & 1 & 1 &  &  & & & && \\
      2 & 1 & $\ticket{2}$ & 1 &  & & & && \\
      3 & 1 & 3 & 3 & 1 &  & &&&  \\
      4 & 1 & 4 & $\ticket{6}$ & 4 & 1 & &&&  \\
      5 & 1 & 5 & 10 & 10 & 5 & 1&&&  \\
      6 & 1 & 6 & 15 & $\ticket{20}$ & 15 & 6& 1&&  \\
      \vdots&  &  &  &  &  & &&$\ddots$&  \\
      \vdots&  && & & & &  & ${{n-1}\choose{k-1}} $  & ${{n-1}\choose{k}} $  \\
      n&  &  & &  & &&  & & ${{n}\choose{k}} $ \\
    \end{tabular}
  \end{center}
\end{table}
The numbers ${{2h}\choose{h}}$ are called \emph{Central Binomial
  Coefficients}, while $ \frac{1}{h+1}{{2h}\choose{h}}$ are called
\emph{Catalan Numbers}.

We finish this section on combinatorics with some exercises.
\begin{exercise}
  Compute ${{ -\frac{1}{2} }\choose{k}} $.
\end{exercise}
\begin{proof}[Sol]
  Using the approach followed in Exercise
  \autoref{exercise:first-on-comb-with-real}, we can build the
  function $f(z) = \frac{1}{\sqrt{1+z}} $ and expand it with
  Taylor. Here we use another approach that follow the definition:
  \begin{displaymath}
    \begin{split}
      {{- \frac{1}{2} }\choose{k}} &= \frac{- \frac{1}{2}(- \frac{1}{2}
        -1)(- \frac{1}{2}-2)\cdots(- \frac{1}{2}-k +1) }{k!} = \\
      &= \frac{- \frac{1}{2}(- \frac{3}{2})(- \frac{5}{2})\cdots(-
        \frac{2k-1}{2}) }{k!} =
      \frac{(-1)^k 1 3 5\cdots (2k-1) }{2^k k!} =\\
      &=\frac{(-1)^k 1 3 5\cdots (2k-1) \quad 2 4 6\cdots 2k } {2^k
        k!\quad 2 4 6\cdots 2k } = \frac{(-1)^k (2k)! }
      {2^k k!\quad 2^k(1 2 3 \cdots k) } =\\
      &= \frac{(-1)^k (2k)! } {2^k k!\quad 2^kk! } =\frac{(-1)^k}{4^k }
      {{2k}\choose{k}}
    \end{split}
  \end{displaymath}

  Doing a little check with Maxima:\\  
\noindent
%%%%%%%%%%%%%%%
%%% INPUT:
\begin{minipage}[t]{8ex}{\color{red}\bf
\begin{verbatim}
(%i117) 
\end{verbatim}}
\end{minipage}
\begin{minipage}[t]{\textwidth}{\color{blue}
\begin{verbatim}
f(z):=1/sqrt(1+z);
taylor(f(z), z, 0, 6);
mapBinomial(x):=binomial (-1/2, x);
map (mapBinomial, [0, 1, 2, 3, 4, 5, 6]);
byDef(k):=(((-1)^k)/(4^k))*binomial(2*k,k);
map (byDef, [0, 1, 2, 3, 4, 5, 6]);
\end{verbatim}}
\end{minipage}
%%% OUTPUT:
\definecolor{labelcolor}{RGB}{100,0,0}
\begin{math}\displaystyle
\parbox{8ex}{\color{labelcolor}(\%o117) }
\mathrm{f}\left( z\right) :=\frac{1}{\sqrt{1+z}}
\end{math}\\
\begin{math}\displaystyle
\parbox{8ex}{\color{labelcolor}(\%o118) }
1-\frac{z}{2}+\frac{3\,{z}^{2}}{8}-\frac{5\,{z}^{3}}{16}+\frac{35\,{z}^{4}}{128}-\frac{63\,{z}^{5}}{256}+\frac{231\,{z}^{6}}{1024}+...
\end{math}\\
\begin{math}\displaystyle
\parbox{8ex}{\color{labelcolor}(\%o119) }
\mathrm{mapBinomial}\left( x\right) :=\begin{pmatrix}-\frac{1}{2}\cr x\end{pmatrix}
\end{math}\\
\begin{math}\displaystyle
\parbox{8ex}{\color{labelcolor}(\%o120) }
[1,-\frac{1}{2},\frac{3}{8},-\frac{5}{16},\frac{35}{128},-\frac{63}{256},\frac{231}{1024}]
\end{math}\\
\begin{math}\displaystyle
\parbox{8ex}{\color{labelcolor}(\%o121) }
\mathrm{byDef}\left( k\right) :=\frac{{\left( -1\right) }^{k}}{{4}^{k}}\,\begin{pmatrix}2\,k\cr k\end{pmatrix}
\end{math}\\
\begin{math}\displaystyle
\parbox{8ex}{\color{labelcolor}(\%o122) }
[1,-\frac{1}{2},\frac{3}{8},-\frac{5}{16},\frac{35}{128},-\frac{63}{256},\frac{231}{1024}]
\end{math}
%%%%%%%%%%%%%%%

\end{proof}